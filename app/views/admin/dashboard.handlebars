<div class="container">
	<div class="row">
		<div class="col-sm-8">
			<h4 style="width: 100%; text-align: center;">Welcome to Admin Panel</h4>
		</div>
		<div class="col-sm-4" style="text-align: right;">
			<button type="button" class="btn-primary" data-toggle="modal" data-target="#adduserForm">&plus; Add User</button>
		</div>
	</div>
	<div class="">
		<div class="col-sm-8" style="height: initial!important;">
			<h5>Email Id</h5>
		</div>
		<div class="col-sm-4" style="height: initial!important;">
			<h5>Payment Status</h5>
		</div>
		<div id="table">
		</div>
	</div>
	<div id="adduserForm" class="modal fade" role="dialog">
	  <div class="modal-dialog">

	    <!-- Modal content-->
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close closeBtn" data-dismiss="modal">&times;</button>
	        <h4 class="modal-title">Add User</h4>
	      </div>
	      <div class="modal-body" style="text-align: center;">
	        <form role="form" method='post' action='/admin/addUser'>
	        	<div class="form-group">
		        	<input type="text" id='emailField' name="email" placeholder="Valid email">
	        	</div>
	        	<div class="form-group">
		        	<input type="text" id='passwordField' name="password" placeholder="password"><br>

	        	</div>
		        <button type="button" id="addUserBtn" class="btn-primary">Add user</button>
	        </form>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default closeBtn" data-dismiss="modal">Close</button>
	      </div>
	    </div>

	  </div>
	</div>
</div>

<script type="text/javascript">
	$.get('/admin/getPaymentStatus', function(data) {
		setTable(data)
	})
	function setTable(data) {
		console.log(data)
		var table = document.getElementById('table')
		var options = ['pending', 'duplicate', 'verified']
		for (var i = 0; i < data.length; i++) {
			if (data[i]["paymentConfirmation"] == '' || data[i]["paymentConfirmation"] == undefined) {
				data[i]["paymentConfirmation"] = 'pending'
			}
				var selectOptions = '<select class="payment-status" data-id="'+data[i]['_id']+'">'
			for(var j = 0; j < 3; j++) {
				if(data[i]["paymentConfirmation"] == options[j]) {
					selectOptions += '<option selected value="'+options[j]+'">'+options[j]+'</option>'
				} else {
					selectOptions += '<option value="'+options[j]+'">'+options[j]+'</option>'
				}
			}
			selectOptions+='</select>'
			table.innerHTML += '<div class="row"><div class="col-sm-8">'+data[i]["email"]+'</div><div class="col-sm-4">'+selectOptions+'</div></div>'
		}
	}
	$(document.body).on('change', '.payment-status', function() {
		var selected = $(this).val()
		var id = $(this).data('id')
		$.post('/admin/updateStatus', {'id': id, 'selected': selected})
	})
	$('#addUserBtn').click(function() {
		var email = $('#emailField').val(), password = $('#passwordField').val()
		if(email != '' && password != '') {
			$.post('/admin/addUser', {'email': email, 'password': password})
			$('#addUserBtn').addClass('btn-success')
		} else {
			$('#addUserBtn').addClass('btn-danger')
		}
	})
	$('.closeBtn').click(function() {
		$('#emailField').val('')
		$('#passwordField').val('')
		$('#addUserBtn').removeClass('btn-success')
		$('#addUserBtn').removeClass('btn-danger')
	})
</script>